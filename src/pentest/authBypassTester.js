const axios = require('axios');

async function testAuthBypass(url, endpoints, defaultCredentials) {
  const results = {};

  for (const endpoint of endpoints) {
    const fullUrl = `${url}${endpoint}`;
    try {
      const response = await axios.get(fullUrl);
      results[endpoint] = response.status === 200 ? 'Accessible' : `Status: ${response.status}`;
    } catch (error) {
      results[endpoint] = error.response ? `Status: ${error.response.status}` : 'Error';
    }
  }

  for (const { username, password } of defaultCredentials) {
    try {
      const response = await axios.post(url, { username, password });
      results[`Default credentials (${username}:${password})`] = response.status === 200 ? 'Login Successful' : `Status: ${response.status}`;
    } catch (error) {
      results[`Default credentials (${username}:${password})`] = error.response ? `Status: ${error.response.status}` : 'Error';
    }
  }

  return results;
}

module.exports = testAuthBypass;
