const dns = require('dns');
const util = require('util');

const resolve4 = util.promisify(dns.resolve4);
const resolve6 = util.promisify(dns.resolve6);
const resolveMx = util.promisify(dns.resolveMx);
const resolveTxt = util.promisify(dns.resolveTxt);
const resolveCname = util.promisify(dns.resolveCname);
const resolveNs = util.promisify(dns.resolveNs);
const resolveSoa = util.promisify(dns.resolveSoa);

async function lookupDNS(domain) {
    const results = {
        A: [],
        AAAA: [],
        MX: [],
        TXT: [],
        CNAME: [],
        NS: [],
        SOA: {}
    };

    try {
        results.A = await resolve4(domain);
    } catch (error) {
        console.error(`Error resolving A records for ${domain}:`, error);
    }

    try {
        results.AAAA = await resolve6(domain);
    } catch (error) {
        console.error(`Error resolving AAAA records for ${domain}:`, error);
    }

    try {
        results.MX = await resolveMx(domain);
    } catch (error) {
        console.error(`Error resolving MX records for ${domain}:`, error);
    }

    try {
        results.TXT = await resolveTxt(domain);
    } catch (error) {
        console.error(`Error resolving TXT records for ${domain}:`, error);
    }

    try {
        results.CNAME = await resolveCname(domain);
    } catch (error) {
        console.error(`Error resolving CNAME records for ${domain}:`, error);
    }

    try {
        results.NS = await resolveNs(domain);
    } catch (error) {
        console.error(`Error resolving NS records for ${domain}:`, error);
    }

    try {
        results.SOA = await resolveSoa(domain);
    } catch (error) {
        console.error(`Error resolving SOA records for ${domain}:`, error);
    }

    return results;
}

module.exports = lookupDNS;
